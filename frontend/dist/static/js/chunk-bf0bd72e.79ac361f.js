(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bf0bd72e"],{1162:function(t,e,a){"use strict";a("c600")},"354c":function(t,e,a){"use strict";a("c8e3")},"4fdd":function(t,e,a){"use strict";a("7a51")},"7a51":function(t,e,a){},8205:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TopNavigation"),a("Essay"),a("div",{staticClass:"footer"},[t._v(" Copyright © Syngou ")])],1)},s=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"topNavigation"},[a("span",{staticClass:"title"},[t._v("医疗文本标注和处理系统")]),a("a",{on:{click:t.exportData}},[t._v("导出数据")]),a("a",{on:{click:t.saveTamporaryData}},[t._v("暂存数据")]),t.avatar?a("div",{staticClass:"right-menu"},[a("el-dropdown",{staticClass:"avatar-container",attrs:{trigger:"click"}},[a("div",{staticClass:"avatar-wrapper"},[a("img",{staticClass:"user-avatar",attrs:{src:t.avatar+"?imageView2/1/w/80/h/80",alt:"用户头像"}})]),a("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("router-link",{attrs:{to:"/"}},[a("el-dropdown-item",[t._v(" 主控台 ")])],1),a("router-link",{attrs:{to:"/text/setting"}},[a("el-dropdown-item",[t._v(" 标注设置 ")])],1),a("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(e){return t.logout(e)}}},[a("span",{staticStyle:{display:"block"}},[t._v("注销")])])],1)],1)],1):a("router-link",{staticStyle:{float:"right"},attrs:{to:"/login"}},[t._v(" 登录 ")]),a("AutoAnnotate")],1)},i=[],r=a("1da1"),l=a("5530"),c=(a("2b3d"),a("d3b7"),a("3ca3"),a("ddb0"),a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{visible:t.annotateModal,title:"自动化标注","modal-append-to-body":!1,width:t.width},on:{"update:visible":function(e){t.annotateModal=e}}},[a("el-collapse",[a("el-collapse-item",{attrs:{title:"说明"}},[a("div",[t._v(" 一键标注全文，用于机器学习自动标注，后台传来要标注的词，前台进行标注，人工检查是否正确 ")]),a("hr"),a("div",[t._v(" 如果每种类型有多个值，请用"),a("span",{staticStyle:{color:"red","font-size":"20px"}},[t._v(" 一个 ")]),t._v(" 空格隔开"),a("br"),a("hr"),a("span",{staticStyle:{color:"red","font-size":"20px"}},[t._v(" 需在最开始时使用（即还未进行标注时），否则会有奇怪的结果 ")]),a("hr"),a("span",[t._v("因为只用于自动化标注，所以部署时此选项不可见")])])])],1),t._l(t.typesInfo,(function(e,n){return a("div",{key:n},[a("el-input",{model:{value:t.inputValues[n],callback:function(e){t.$set(t.inputValues,n,e)},expression:"inputValues[index]"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[a("el-button",[t._v(" "+t._s(e.value)+" ")])],1)])],1)})),a("span",{staticStyle:{display:"flex","justify-content":"center","align-items":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.autoAnnotate}},[t._v("确定")])],1)],2)],1)}),d=[],u=a("2909"),p=(a("99af"),a("25f0"),a("1276"),a("ac1f"),a("498a"),a("4360")),f=a("dd44"),h={buttonStyle:function(){return"cursor:pointer;margin-left:5px"},textStyle:function(t){return"border:5px solid ".concat(f["a"].state.typesInfo[t].color,";background-color:").concat(f["a"].state.typesInfo[t].color,";border-radius: 10px;")},annotate:function(t,e){var a=this,n=document.querySelector("#essay"),s=window.getSelection().getRangeAt(0),o=s.cloneRange();o.selectNodeContents(n),o.setEnd(s.startContainer,s.startOffset);var i=Object(u["a"])(o.toString()).length,r=i+Object(u["a"])(s.toString()).length,l=window.getSelection().toString(),c={label:t.split("-")[0],start_offset:i,end_offset:r,text:l,user:1,updated_at:new Date};p["a"].dispatch("annotate/addToList",{id:t,annotateData:c});var d=this.textStyle(e);if(l.length>0){var f=document.createElement("i");f.setAttribute("id",t),f.addEventListener("click",(function(){a.deleteById(t)})),f.setAttribute("class","el-icon-close"),f.setAttribute("style",this.buttonStyle());var h=document.createElement("span");h.setAttribute("style",d);var v=window.getSelection().getRangeAt(0);v.surroundContents(h),h.appendChild(f),window.getSelection().removeAllRanges(),p["a"].state.annotate.id++}},deleteById:function(t){var e=document.getElementById("essay"),a=document.getElementById(t).parentNode,n=document.createTextNode(a.innerText.trim()),s=a.innerText.trim();e.insertBefore(n,a),e.removeChild(a),p["a"].dispatch("annotate/deleteDataFromList",{type:t,text:s})}},v=a("2f62"),g={name:"AutoAnnotate",data:function(){return{annotateModal:!1,inputValues:[],width:""}},computed:Object(l["a"])({},Object(v["b"])(["typesInfo"])),created:function(){var t=this;this.$bus.$on("autoAnnotate",(function(){t.annotateModal=!0}))},mounted:function(){var t=window.innerWidth;this.width=t<=450?"80%":"30%"},methods:{autoAnnotate:function(){this.annotateModal=!1,h.autoAnnotate(this.inputValues),this.inputValues=[]}}},m=g,w=a("2877"),y=Object(w["a"])(m,c,d,!1,null,"edd3f382",null),b=y.exports,_={name:"TopNavigation",components:{AutoAnnotate:b},computed:Object(l["a"])({},Object(v["b"])(["avatar","annotateData","typesInfo"])),methods:{logout:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("user/logout");case 2:case"end":return e.stop()}}),e)})))()},exportData:function(){var t=window.URL.createObjectURL(new Blob([JSON.stringify({id:this.$store.state.annotate.essayId,text:this.$store.state.annotate.annotateText,annotations:this.annotateData})])),e=document.createElement("a");e.href=t,e.setAttribute("download","file".concat(this.$store.state.annotate.essayId,".jsonl")),document.body.appendChild(e),e.click()},saveTamporaryData:function(){this.$message.info("待开发")}}},C=_,x=(a("cbbf"),Object(w["a"])(C,o,i,!1,null,"9ffcefe0",null)),k=x.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"paper"}},[a("link",{attrs:{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css",integrity:"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u",crossorigin:"anonymous"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDialog,expression:"showDialog"}],ref:"showDialog",staticClass:"optionDialog"},[t._l(t.typesInfo,(function(e,n){return a("button",{key:n,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(n+"-"+t.$store.state.annotate.id,n)}}},[t._v(" "+t._s(e.value)+"("+t._s(e.shortcut)+") ")])})),a("button",{on:{click:t.translateText}},[t._v(" 翻译 ")])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTranslateCard,expression:"showTranslateCard"}],ref:"translateCard",staticClass:"translate-card"},[a("i",{staticClass:"el-message__closeBtn el-icon-close delete-button",on:{click:function(e){t.showTranslateCard=!1}}}),a("TranslateCard",{attrs:{data:t.translateResult}})],1),a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"panel panel-default"},[t._m(0),a("div",{staticClass:"panel-body"},[a("div",{staticClass:"side"},[t._l(t.typesInfo,(function(e,n){return a("button",{key:n,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(n+"-"+t.$store.state.annotate.id,n)}}},[t._v(" "+t._s(e.value)+"("+t._s(e.shortcut)+") ")])})),a("br"),a("br"),a("router-link",{attrs:{to:"/text/setting"}},[t._v(" 添加新分类 ")])],2)])])]),a("div",{staticClass:"col-md-10"},[a("div",{staticClass:"panel panel-default"},[t._m(1),a("div",{staticClass:"panel-body"},[a("pre",{staticClass:"essay-content",style:"font-size:"+t.$store.state.annotate.fontSize+"px",attrs:{id:"essay"},domProps:{textContent:t._s(t.$store.state.annotate.annotateText)},on:{mouseup:function(e){return t.getSelection(e)}}})])])])])])])},$=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-heading"},[a("div",{staticClass:"head"},[t._v(" 现有标签 ")]),a("hr"),a("div",{staticClass:"tip"},[t._v(" (选中文本后单击任一标签即可标注) ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-heading"},[a("div",{staticClass:"head"},[t._v(" 文章如下 ")])])}],T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[t._v(" "+t._s(t.data.result)+" ")])},j=[],O={name:"TranslateCard",props:{data:{type:Object,default:function(){return{}}}}},A=O,D=(a("354c"),Object(w["a"])(A,T,j,!1,null,"4ca5c4ef",null)),E=D.exports,I=a("bc3a"),R=a.n(I),B=a("5c96"),P=R.a.create({baseURL:"http://localhost:8000",timeout:5e3});P.interceptors.response.use((function(t){var e=t.data;return 2e4!==e.code?(Object(B["Message"])({type:"error",showClose:!0,message:e.message||"Error",duration:3e3}),Promise.reject(new Error(e.message||"请求发生错误"))):e}),(function(t){return Object(B["Message"])({message:"网络请求发生错误，请检查您的网络状态或联系管理员",showClose:!0,type:"error",duration:3e3}),Promise.reject(t)}));var N=P,V={translate:function(t){return N({url:"translate/?text=".concat(t),method:"get"})}},M={name:"Essays",components:{TranslateCard:E},data:function(){return{showDialog:!1,selectText:"",showTranslateCard:!1,translateResult:{}}},computed:Object(l["a"])({},Object(v["b"])(["typesInfo"])),created:function(){this.annotateByShortcut()},methods:{setBoxPosition:function(t,e){this.$refs.showDialog.style.left=t-100+"px",this.$refs.showDialog.style.top=e+20+"px",this.$refs.translateCard.style.left=t+10+"px",this.$refs.translateCard.style.top=e+10+"px"},getSelection:function(t){""!==window.getSelection().toString()?(this.selectText=window.getSelection().toString(),this.setBoxPosition(t.pageX,t.pageY),this.$refs.showDialog.style.display="block",this.showDialog=!0):this.showDialog=!1},annotateText:function(t,e){this.showDialog=!1,h.annotate(t,e)},annotateByShortcut:function(){var t=this;document.onkeydown=function(e){var a,n=e.key,s=t.$store.state.annotate.id;for(t.showDialog=!1,a=0;a<t.$store.state.annotate.typesInfo.length;a++)if(n===t.$store.state.annotate.typesInfo[a].shortcut){h.annotate(String(a)+s,a);break}}},translateText:function(){var t=this;this.showDialog=!1;var e=window.getSelection().toString();V.translate(e).then((function(e){t.translateResult=e.data,t.showTranslateCard=!0}))}}},L=M,z=(a("1162"),Object(w["a"])(L,S,$,!1,null,"a65f163a",null)),J=z.exports,U={name:"Home",components:{TopNavigation:k,Essay:J},mounted:function(){this.isPC()},methods:{isPC:function(){for(var t=["Android","iPhone","Windows Phone","iPad","iPod"],e=navigator.userAgent,a=0;a<t.length;a++)if(e.indexOf(t[a])>0){this.$message.warning({message:"手机是无法进行标注的哦,请使用电脑浏览器。",duration:5e3,showClose:!0});break}}}},H=U,Y=(a("4fdd"),Object(w["a"])(H,n,s,!1,null,"2c8cfee2",null));e["default"]=Y.exports},c600:function(t,e,a){},c8e3:function(t,e,a){},cbbf:function(t,e,a){"use strict";a("ead8")},ead8:function(t,e,a){}}]);