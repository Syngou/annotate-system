(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50a60d7f"],{"063b":function(t,e,a){"use strict";a("b29a")},7632:function(t,e,a){"use strict";a("c5ba")},"84f5":function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return i}));var n=a("b775");function o(t){return Object(n["a"])({url:"api/labels/add/",method:"POST",data:t})}function s(){return Object(n["a"])({url:"api/labels/get/"})}function i(t){return Object(n["a"])({url:"api/translate/?text=".concat(t)})}},"99ac":function(t,e,a){},"9ed6":function(t,e,a){},a5a6:function(t,e,a){"use strict";a("9ed6")},b270:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("TopNavigation"),a("AnnotateContent"),a("div",{staticClass:"footer"},[t._v(" Copyright © Syngou ")])],1)},o=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"topNavigation"},[a("span",{staticClass:"title"},[t._v("医疗文本标注和处理系统")]),a("a",{on:{click:t.exportData}},[t._v("导出数据")]),a("a",{on:{click:t.saveTamporaryData}},[t._v("暂存数据")]),t.avatar?a("div",{staticClass:"right-menu"},[a("el-dropdown",{staticClass:"avatar-container",attrs:{trigger:"click"}},[a("div",{staticClass:"avatar-wrapper"},[a("img",{staticClass:"user-avatar",attrs:{src:t.avatar,alt:"用户头像"}})]),a("el-dropdown-menu",{staticClass:"user-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("router-link",{attrs:{to:"/"}},[a("el-dropdown-item",[t._v(" 主控台 ")])],1),a("router-link",{attrs:{to:"/labelsManage"}},[a("el-dropdown-item",[t._v(" 标签管理 ")])],1),a("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(e){return t.logout(e)}}},[a("span",{staticStyle:{display:"block"}},[t._v("注销")])])],1)],1)],1):a("router-link",{staticStyle:{float:"right"},attrs:{to:"/login"}},[t._v(" 登录 ")]),a("output-options",{ref:"outputOptions"})],1)},i=[],r=a("c964"),l=a("f3f3"),c=(a("96cf"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{title:"输出选项",width:"fit-content",visible:t.dialogVisible,modal:!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",[a("el-form-item",{attrs:{label:"文件名"}},[a("el-input",{attrs:{placeholder:"请输入文件名，默认为 output"},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}})],1),a("el-form-item",{attrs:{label:"后缀名"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.fileFormat,callback:function(e){t.fileFormat=e},expression:"fileFormat"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),a("div",{staticClass:"btn-group"},[a("el-button",{attrs:{type:"primary"},on:{click:t.outputFile}},[t._v(" 确定 ")]),a("el-button",{attrs:{type:"danger"},on:{click:function(e){t.dialogVisible=!1}}},[t._v(" 取消 ")])],1)],1)],1)}),u=[],d=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("99af"),a("2f62")),f={data:function(){return{dialogVisible:!1,options:[{value:"jsonl",label:"jsonl"},{value:"json",label:"json"},{value:"txt",label:"txt"}],fileName:"output",fileFormat:"jsonl"}},computed:Object(l["a"])({},Object(d["b"])(["annotateData"])),methods:{outputFile:function(){this.dialogVisible=!1;var t=window.URL.createObjectURL(new Blob([JSON.stringify({id:this.$store.state.annotate.essayId,text:this.$store.state.annotate.annotateText,annotations:this.annotateData})])),e=document.createElement("a");e.href=t,e.setAttribute("download","".concat(this.fileName,".").concat(this.fileFormat)),document.body.appendChild(e),e.click()}}},p=f,v=(a("fda6"),a("0c7c")),b=Object(v["a"])(p,c,u,!1,null,"c89071fa",null),h=b.exports,m={name:"TopNavigation",components:{OutputOptions:h},computed:Object(l["a"])({},Object(d["b"])(["avatar"])),methods:{logout:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("user/logout");case 2:case"end":return e.stop()}}),e)})))()},exportData:function(){this.$refs.outputOptions.dialogVisible=!0},saveTamporaryData:function(){this.$message.info("待开发")}}},g=m,w=(a("7632"),Object(v["a"])(g,s,i,!1,null,"697a5984",null)),C=w.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"paper"}},[a("link",{attrs:{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css",integrity:"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u",crossorigin:"anonymous"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showDialog,expression:"showDialog"}],ref:"showDialog",staticClass:"optionDialog"},[t._l(t.labels,(function(e,n){return a("button",{key:n,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(n+"-"+t.$store.state.annotate.id,n)}}},[t._v(" "+t._s(e.text)+"("+t._s(e.shortcut)+") ")])})),a("button",{on:{click:t.translateText}},[t._v(" 翻译 ")])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTranslateCard,expression:"showTranslateCard"}],ref:"translateCard",staticClass:"translate-card"},[a("i",{staticClass:"el-message__closeBtn el-icon-close delete-button",on:{click:function(e){t.showTranslateCard=!1}}}),a("TranslateCard",{attrs:{data:t.translateResult}})],1),a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-2"},[a("div",{staticClass:"panel panel-default"},[t._m(0),a("div",{staticClass:"panel-body"},[a("div",{staticClass:"side"},[t._l(t.labels,(function(e,n){return a("button",{key:n,style:{backgroundColor:e.color},on:{click:function(e){return t.annotateText(n+"-"+t.$store.state.annotate.id,n)}}},[t._v(" "+t._s(e.text)+"("+t._s(e.shortcut)+") ")])})),a("br"),a("br"),a("router-link",{attrs:{to:"/labelsManage"}},[t._v(" 添加新标签 ")])],2)])])]),a("div",{staticClass:"col-md-10"},[a("div",{staticClass:"panel panel-default"},[t._m(1),a("div",{staticClass:"panel-body"},[a("pre",{staticClass:"annotate-content",style:"font-size:"+t.$store.state.annotate.fontSize+"px",attrs:{id:"annotateContent"},domProps:{textContent:t._s(t.$store.state.annotate.annotateText)},on:{mouseup:function(e){return t.getSelection(e)}}})])])])])])])},x=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-heading"},[a("div",{staticClass:"head"},[t._v(" 现有标签 ")]),a("hr"),a("div",{staticClass:"tip"},[t._v(" (选中文本后单击任一标签即可标注) ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"panel-heading"},[a("div",{staticClass:"head"},[t._v(" 文章如下 ")])])}],y=(a("25f0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[t._v(" "+t._s(t.data.result)+" ")])}),k=[],O={name:"TranslateCard",props:{data:{type:Object,default:function(){return{}}}}},T=O,j=(a("063b"),Object(v["a"])(T,y,k,!1,null,"01c33c9b",null)),S=j.exports,$=a("d0ff"),D=(a("ac1f"),a("1276"),a("498a"),a("4360"));function E(){return"cursor:pointer;margin-left:5px"}function A(t){return"border:5px solid ".concat(D["a"].state.annotate.labels[t].color,";\n          background-color:").concat(D["a"].state.annotate.labels[t].color,";\n          border-radius: 10px;")}function N(t,e){var a=window.getSelection().toString(),n=A(e);if(a.length>0){var o=document.querySelector("#annotateContent"),s=window.getSelection().getRangeAt(0),i=s.cloneRange();i.selectNodeContents(o),i.setEnd(s.startContainer,s.startOffset);var r=Object($["a"])(i.toString()).length,l=r+Object($["a"])(s.toString()).length,c={id:t.split("-")[1],label:t.split("-")[0],start_offset:r,end_offset:l,text:a,user:1,updated_at:new Date};D["a"].dispatch("annotate/addToList",{id:t,annotateData:c});var u=document.createElement("i");u.setAttribute("id",t),u.addEventListener("click",(function(){R(t)})),u.setAttribute("class","el-icon-close"),u.setAttribute("style",E());var d=document.createElement("span");d.setAttribute("style",n);var f=window.getSelection().getRangeAt(0);f.surroundContents(d),d.appendChild(u),window.getSelection().removeAllRanges(),D["a"].state.annotate.id++}}function R(t){var e=document.getElementById("annotateContent"),a=document.getElementById(t).parentNode,n=document.createTextNode(a.innerText.trim()),o=a.innerText.trim();e.insertBefore(n,a),e.removeChild(a),D["a"].dispatch("annotate/deleteDataFromList",{type:t,text:o})}var P=a("84f5"),B={name:"Essays",components:{TranslateCard:S},data:function(){return{showDialog:!1,selectText:"",showTranslateCard:!1,translateResult:{}}},computed:Object(l["a"])({},Object(d["b"])(["labels"])),created:function(){this.annotateByShortcut()},methods:{setBoxPosition:function(t,e){this.$refs.showDialog.style.left="".concat(t-100,"px"),this.$refs.showDialog.style.top="".concat(e+20,"px"),this.$refs.translateCard.style.left="".concat(t+10,"px"),this.$refs.translateCard.style.top="".concat(e+10,"px")},getSelection:function(t){""!==window.getSelection().toString()?(this.selectText=window.getSelection().toString(),this.setBoxPosition(t.pageX,t.pageY),this.$refs.showDialog.style.display="block",this.showDialog=!0):this.showDialog=!1},annotateText:function(t,e){this.showDialog=!1,N(t,e)},annotateByShortcut:function(){var t=this;document.onkeydown=function(e){var a=e.key,n=t.$store.state.annotate.id;t.showDialog=!1;for(var o=0;o<t.labels.length;o++)if(a===t.labels[o].shortcut){N(o+"-"+n,o);break}}},translateText:function(){var t=this;this.showDialog=!1;var e=window.getSelection().toString();Object(P["c"])(e).then((function(e){t.translateResult=e.data,t.showTranslateCard=!0}))}}},F=B,V=(a("a5a6"),Object(v["a"])(F,_,x,!1,null,"5724e1ad",null)),L=V.exports,I={name:"Annotate",components:{TopNavigation:C,AnnotateContent:L},mounted:function(){this.isPC()},methods:{isPC:function(){for(var t=["Android","iPhone","Windows Phone","iPad","iPod"],e=navigator.userAgent,a=0;a<t.length;a++)if(e.indexOf(t[a])>0){this.$message.warning({message:"手机是无法进行标注的哦,请使用电脑浏览器。",duration:5e3,showClose:!0});break}}}},J=I,z=(a("b5fb"),Object(v["a"])(J,n,o,!1,null,"260669d7",null));e["default"]=z.exports},b29a:function(t,e,a){},b5fb:function(t,e,a){"use strict";a("e5a7")},c5ba:function(t,e,a){},e5a7:function(t,e,a){},fda6:function(t,e,a){"use strict";a("99ac")}}]);